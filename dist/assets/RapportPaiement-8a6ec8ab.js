import{_ as y,k as f,o as l,c,b as e,m as h,p,F as m,f as _,t as o}from"./index-8845255c.js";import"./_baseGetTag-2ed90e23.js";const b={data(){return{selectedStatus:"",isLoading:!1,searchQuery:"",paiements:[],parentNames:{},startDate:"",endDate:""}},computed:{filteredPaiements(){const a=this.searchQuery.trim().toLowerCase();return this.paiements.filter(t=>{const n=t.eleve.nom.toLowerCase().includes(a)||t.eleve.prenom.toLowerCase().includes(a)||this.parentNames[t.eleve.famille_id].toLowerCase().includes(a),i=this.isDateInRange(t.created_at);return n&&t.status==="Completed"&&i})},calculateTotalMontant(){return this.filteredPaiements.reduce((t,n)=>t+n.montant,0)+" DHs"}},methods:{navigateToPayer(){this.$router.push({name:"CreatePaiement"})},isDateInRange(a){if(!this.startDate||!this.endDate)return!0;const t=new Date(a),n=new Date(this.startDate),i=new Date(this.endDate);return t>=n&&t<=i},formatDate(a){const t={day:"2-digit",month:"2-digit",year:"numeric"};return new Date(a).toLocaleDateString("en-GB",t)},clearFilters(){this.searchQuery="",this.selectedStatus=""},async fetchPaiements(){try{this.isLoading=!0;const a=await f.get("/comptable/paiements-modes");this.paiements=a.data,this.isLoading=!1}catch(a){console.error("Error fetching paiements:",a),this.isLoading=!1}},async fetchParentNames(){try{const t=(await f.get("/comptable/parents")).data;this.parentNames=t.reduce((n,i)=>(n[i.id]=i.nom_complet,n),{}),console.log(this.parentNames)}catch(a){console.error("Error fetching parents:",a)}}},watch:{},async mounted(){await Promise.all([this.fetchPaiements(),this.fetchParentNames()])}},x={class:"antialiased bg-gray-100 text-gray-600 my-16 px-4"},v={class:"flex flex-col justify-center h-full"},D={class:"w-full max-w-6xlxl mx-auto bg-white shadow-lg rounded-sm border border-gray-200"},P=e("header",{class:"px-5 py-4 border-b border-gray-100"},[e("h2",{class:"font-semibold text-gray-800"},"Rapport des recettes")],-1),k={class:"p-3"},L={class:"flex items-center justify-between mb-4"},N={class:"flex space-x-4"},C={class:"overflow-x-auto"},S={key:0,class:"table-auto w-full"},Q=e("thead",{class:"text-xs font-semibold uppercase text-gray-400 bg-gray-50"},[e("tr",null,[e("th",{class:"p-4 whitespace-nowrap"},[e("div",{class:"font-semibold text-left"},"Date")]),e("th",{class:"p-4 whitespace-nowrap"},[e("div",{class:"font-semibold text-left"},"Nº Reçu")]),e("th",{class:"p-4 whitespace-nowrap"},[e("div",{class:"font-semibold text-left"},"Mode paiement")]),e("th",{class:"p-4 whitespace-nowrap"},[e("div",{class:"font-semibold text-left"},"Status")]),e("th",{class:"p-4 whitespace-nowrap"},[e("div",{class:"font-semibold text-left"},"Eleve")]),e("th",{class:"p-4 whitespace-nowrap"},[e("div",{class:"font-semibold text-left"},"Niveau")]),e("th",{class:"p-4 whitespace-nowrap"},[e("div",{class:"font-semibold text-left"},"Parent")]),e("th",{class:"p-4 whitespace-nowrap"},[e("div",{class:"font-semibold text-left"},"Montant")])])],-1),F={class:"text-sm divide-y divide-gray-100"},M={class:"p-4 whitespace-nowrap"},R={class:"text-left"},T={class:"p-4 whitespace-nowrap"},j={class:"text-left"},B={class:"p-4 whitespace-nowrap"},E={class:"p-4 whitespace-nowrap"},V={class:"bg-green-200 text-green-800 rounded-full py-1 px-3 text-center"},I={class:"p-4 whitespace-nowrap"},U={class:"font-medium text-gray-800"},H={class:"p-4 whitespace-nowrap"},z={class:"text-left"},G={class:"p-4 whitespace-nowrap"},q={class:"text-left"},A={class:"p-4 whitespace-nowrap"},J={class:"text-left"},K=e("td",{colspan:"7",class:"p-4 whitespace-nowrap font-semibold just text-right text-yellow-500"}," Total Montant: ",-1),O={class:"p-4 whitespace-nowrap font-semibold text-left"},W=e("td",{class:"p-4 whitespace-nowrap"},null,-1),X={key:1,class:"flex justify-center items-center h-32"},Y=e("div",{class:"w-12 h-12 border-t-4 border-blue-500 border-solid rounded-full animate-spin"},null,-1),Z=[Y];function $(a,t,n,i,r,d){return l(),c("section",x,[e("div",v,[e("div",D,[P,e("div",k,[e("div",L,[e("div",N,[h(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>r.searchQuery=s),placeholder:"Search",class:"block w-48 rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"},null,512),[[p,r.searchQuery]]),h(e("input",{type:"date","onUpdate:modelValue":t[1]||(t[1]=s=>r.startDate=s),class:"block rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"},null,512),[[p,r.startDate]]),h(e("input",{type:"date","onUpdate:modelValue":t[2]||(t[2]=s=>r.endDate=s),class:"block rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50"},null,512),[[p,r.endDate]])]),e("button",{onClick:t[3]||(t[3]=(...s)=>d.clearFilters&&d.clearFilters(...s)),class:"px-3 py-1 bg-gray-300 rounded-md hover:bg-gray-400 focus:outline-none"}," Clear Filters ")]),e("div",C,[r.isLoading?(l(),c("div",X,Z)):(l(),c("table",S,[Q,e("tbody",F,[(l(!0),c(m,null,_(d.filteredPaiements,(s,w)=>(l(),c("tr",{key:w},[e("td",M,[e("div",R,o(d.formatDate(s.created_at)),1)]),e("td",T,[e("div",j,o(s.num_recu),1)]),e("td",B,[e("ul",null,[(l(!0),c(m,null,_(s.modes,(u,g)=>(l(),c("li",{key:g},o(u.type)+" - "+o(u.montant),1))),128))])]),e("td",E,[e("div",V,o(s.status),1)]),e("td",I,[e("div",U,o(s.eleve.nom)+" "+o(s.eleve.prenom),1)]),e("td",H,[e("div",z,o(s.eleve.niveau),1)]),e("td",G,[e("div",q,o(r.parentNames[s.eleve.famille_id]),1)]),e("td",A,[e("div",J,o(s.montant)+" DHs",1)])]))),128)),e("tr",null,[K,e("td",O,o(d.calculateTotalMontant),1),W])])]))])])])])])}const se=y(b,[["render",$]]);export{se as default};
